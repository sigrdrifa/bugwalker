<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Handlers related to Bug API endpoints</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">BugApi</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="BugApi.html#getBugsHandler"><span class="hs-identifier">getBugsHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>      </span><span class="annot"><a href="BugApi.html#getBugsByUserHandler"><span class="hs-identifier">getBugsByUserHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="BugApi.html#getBugHandler"><span class="hs-identifier">getBugHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>      </span><span class="annot"><a href="BugApi.html#postBugHandler"><span class="hs-identifier">postBugHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="BugApi.html#putBugHandler"><span class="hs-identifier">putBugHandler</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="BugApi.html#deleteBugHandler"><span class="hs-identifier">deleteBugHandler</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span class="hs-comment">---</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Servant</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="hs-identifier">Handler</span></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><span class="hs-identifier">err400</span></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><span class="hs-identifier">err401</span></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><span class="hs-identifier">err404</span></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><span class="hs-identifier">err500</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><span class="hs-identifier">ServerError</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">errBody</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">packChars</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int64</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-comment">---</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AuthTypes.html"><span class="hs-identifier">AuthTypes</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="AuthTypes.html#isUserInit"><span class="hs-identifier">isUserInit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier">AuthenticatedUser</span></a></span><span class="hs-special">(</span><span class="annot"><a href="AuthTypes.html#auId"><span class="hs-identifier">auId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IOH.html"><span class="hs-identifier">IOH</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IOH.html#changeBug"><span class="hs-identifier">changeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><a href="IOH.html#getBug"><span class="hs-identifier">getBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><a href="IOH.html#getBugs"><span class="hs-identifier">getBugs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="IOH.html#getBugsByUser"><span class="hs-identifier">getBugsByUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="IOH.html#removeBug"><span class="hs-identifier">removeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><a href="IOH.html#storeBug"><span class="hs-identifier">storeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier">IOHError</span></a></span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHFetchError"><span class="hs-identifier">IOHFetchError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IOH.html#IOHAuthError"><span class="hs-identifier">IOHAuthError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ApiTypes.html"><span class="hs-identifier">ApiTypes</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier">Bug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier">BugChangedResponseMessage</span></a></span><span class="hs-special">(</span><span class="annot"><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier">BugChangedResponseMessage</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier">BugDetail</span></a></span><span class="hs-special">(</span><span class="annot"><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier">bugdtSubmitter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-comment">----</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Handles fetching bugs</span><span>
</span><span id="line-44"></span><span class="annot"><a href="BugApi.html#getBugsHandler"><span class="hs-identifier hs-type">getBugsHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Captured limit of how many bugs to get</span><span>
</span><span id="line-45"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier hs-type">Bug</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span id="getBugsHandler"><span class="annot"><span class="annottext">getBugsHandler :: Maybe Int -&gt; Handler [Bug]
</span><a href="BugApi.html#getBugsHandler"><span class="hs-identifier hs-var hs-var">getBugsHandler</span></a></span></span><span> </span><span id="local-6989586621679353466"><span class="annot"><span class="annottext">limit :: Maybe Int
</span><a href="#local-6989586621679353466"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679353466"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353465"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679353465"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO [Bug] -&gt; Handler [Bug]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Bug] -&gt; Handler [Bug]) -&gt; IO [Bug] -&gt; Handler [Bug]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [Bug]
</span><a href="IOH.html#getBugs"><span class="hs-identifier hs-var">IOH.getBugs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353465"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO [Bug] -&gt; Handler [Bug]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Bug] -&gt; Handler [Bug]) -&gt; IO [Bug] -&gt; Handler [Bug]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [Bug]
</span><a href="IOH.html#getBugs"><span class="hs-identifier hs-var">IOH.getBugs</span></a></span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="hs-comment">-- Default to 200</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Handles fetching bugs by userId</span><span>
</span><span id="line-51"></span><span class="annot"><a href="BugApi.html#getBugsByUserHandler"><span class="hs-identifier hs-type">getBugsByUserHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ unique userId to fetch bugs submitted by</span><span>
</span><span id="line-52"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier hs-type">Bug</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-53"></span><span id="getBugsByUserHandler"><span class="annot"><span class="annottext">getBugsByUserHandler :: Int64 -&gt; Handler [Bug]
</span><a href="BugApi.html#getBugsByUserHandler"><span class="hs-identifier hs-var hs-var">getBugsByUserHandler</span></a></span></span><span> </span><span id="local-6989586621679353464"><span class="annot"><span class="annottext">uId :: Int64
</span><a href="#local-6989586621679353464"><span class="hs-identifier hs-var">uId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [Bug] -&gt; Handler [Bug]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [Bug] -&gt; Handler [Bug]) -&gt; IO [Bug] -&gt; Handler [Bug]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO [Bug]
</span><a href="IOH.html#getBugsByUser"><span class="hs-identifier hs-var">IOH.getBugsByUser</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353464"><span class="hs-identifier hs-var">uId</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Handles fetching a single bug</span><span>
</span><span id="line-56"></span><span class="annot"><a href="BugApi.html#getBugHandler"><span class="hs-identifier hs-type">getBugHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ unique bugId to fetch</span><span>
</span><span id="line-57"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">BugDetail</span></a></span><span>
</span><span id="line-58"></span><span id="getBugHandler"><span class="annot"><span class="annottext">getBugHandler :: Int64 -&gt; Handler BugDetail
</span><a href="BugApi.html#getBugHandler"><span class="hs-identifier hs-var hs-var">getBugHandler</span></a></span></span><span> </span><span id="local-6989586621679353463"><span class="annot"><span class="annottext">x :: Int64
</span><a href="#local-6989586621679353463"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679353462"><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353462"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe BugDetail) -&gt; Handler (Maybe BugDetail)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe BugDetail) -&gt; Handler (Maybe BugDetail))
-&gt; IO (Maybe BugDetail) -&gt; Handler (Maybe BugDetail)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe BugDetail)
</span><a href="IOH.html#getBug"><span class="hs-identifier hs-var">IOH.getBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353463"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353462"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353461"><span class="annot"><span class="annottext">r :: BugDetail
</span><a href="#local-6989586621679353461"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Handler BugDetail
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353461"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugDetail
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err404</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Four-Oh-Four! The requested bug was not found.&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | (Init+ Only) Handles fsubmitting a new request</span><span>
</span><span id="line-66"></span><span class="annot"><a href="BugApi.html#postBugHandler"><span class="hs-identifier hs-type">postBugHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the requesting user (Init+)</span><span>
</span><span id="line-67"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">BugDetail</span></a></span><span> </span><span class="hs-comment">-- ^ the bug data to insert</span><span>
</span><span id="line-68"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="annot"><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-type">BugChangedResponseMessage</span></a></span><span>
</span><span id="line-69"></span><span id="postBugHandler"><span class="annot"><span class="annottext">postBugHandler :: AuthenticatedUser -&gt; BugDetail -&gt; Handler BugChangedResponseMessage
</span><a href="BugApi.html#postBugHandler"><span class="hs-identifier hs-var hs-var">postBugHandler</span></a></span></span><span> </span><span id="local-6989586621679353460"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353460"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353459"><span class="annot"><span class="annottext">bd :: BugDetail
</span><a href="#local-6989586621679353459"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Handler () -&gt; Handler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64
</span><a href="AuthTypes.html#auId"><span class="hs-identifier hs-var hs-var">auId</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353460"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int64
</span><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier hs-var hs-var">bugdtSubmitter</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353459"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Handler ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err400</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;UserID mismatch on Bug&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Handler () -&gt; Handler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserInit"><span class="hs-identifier hs-var">isUserInit</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353460"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Handler ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err401</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;User must be Initiate role or higher&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679353457"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353457"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Int64) -&gt; Handler (Maybe Int64)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Int64) -&gt; Handler (Maybe Int64))
-&gt; IO (Maybe Int64) -&gt; Handler (Maybe Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; IO (Maybe Int64)
</span><a href="IOH.html#storeBug"><span class="hs-identifier hs-var">IOH.storeBug</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353459"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353457"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353456"><span class="annot"><span class="annottext">id :: Int64
</span><a href="#local-6989586621679353456"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><span class="annottext">BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage)
-&gt; BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64 -&gt; String -&gt; String -&gt; BugChangedResponseMessage
</span><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-var">BugChangedResponseMessage</span></a></span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353456"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;OK&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BugChangedResponseMessage)
-&gt; String -&gt; BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-78"></span><span>               </span><span class="annot"><span class="hs-string">&quot;Inserted bug with ID &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353456"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err500</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | (Init+ only) Attempts to update a bug with the provided data</span><span>
</span><span id="line-82"></span><span class="annot"><a href="BugApi.html#putBugHandler"><span class="hs-identifier hs-type">putBugHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the requesting user (init+)</span><span>
</span><span id="line-83"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique id of the bug to update</span><span>
</span><span id="line-84"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">BugDetail</span></a></span><span> </span><span class="hs-comment">-- ^ updated bug data to insert</span><span>
</span><span id="line-85"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="annot"><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-type">BugChangedResponseMessage</span></a></span><span>
</span><span id="line-86"></span><span id="putBugHandler"><span class="annot"><span class="annottext">putBugHandler :: AuthenticatedUser
-&gt; Int64 -&gt; BugDetail -&gt; Handler BugChangedResponseMessage
</span><a href="BugApi.html#putBugHandler"><span class="hs-identifier hs-var hs-var">putBugHandler</span></a></span></span><span> </span><span id="local-6989586621679353454"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353454"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353453"><span class="annot"><span class="annottext">id :: Int64
</span><a href="#local-6989586621679353453"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621679353452"><span class="annot"><span class="annottext">bd :: BugDetail
</span><a href="#local-6989586621679353452"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Handler () -&gt; Handler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64
</span><a href="AuthTypes.html#auId"><span class="hs-identifier hs-var hs-var">auId</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353454"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int64
</span><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier hs-var hs-var">bugdtSubmitter</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353452"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Handler ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err400</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;UserID mismatch on Bug&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Handler () -&gt; Handler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserInit"><span class="hs-identifier hs-var">isUserInit</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353454"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Handler ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err401</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;User must be Initiate role or higher&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679353451"><span class="annot"><span class="annottext">Either IOHError Int64
</span><a href="#local-6989586621679353451"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either IOHError Int64) -&gt; Handler (Either IOHError Int64)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either IOHError Int64) -&gt; Handler (Either IOHError Int64))
-&gt; IO (Either IOHError Int64) -&gt; Handler (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
-&gt; Int64 -&gt; BugDetail -&gt; IO (Either IOHError Int64)
</span><a href="IOH.html#changeBug"><span class="hs-identifier hs-var">IOH.changeBug</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353454"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353453"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353452"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64
</span><a href="#local-6989586621679353451"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679353450"><span class="annot"><span class="annottext">dbId :: Int64
</span><a href="#local-6989586621679353450"><span class="hs-identifier hs-var">dbId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="annottext">BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage)
-&gt; BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64 -&gt; String -&gt; String -&gt; BugChangedResponseMessage
</span><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-var">BugChangedResponseMessage</span></a></span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353450"><span class="hs-identifier hs-var">dbId</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;OK&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BugChangedResponseMessage)
-&gt; String -&gt; BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Updated bug with ID &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353450"><span class="hs-identifier hs-var">dbId</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-type">IOHAuthError</span></a></span><span> </span><span id="local-6989586621679353449"><span class="annot"><span class="annottext">m :: String
</span><a href="#local-6989586621679353449"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err400</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">packChars</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353449"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-type">IOHFetchError</span></a></span><span> </span><span id="local-6989586621679353448"><span class="annot"><span class="annottext">m :: String
</span><a href="#local-6989586621679353448"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err404</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">packChars</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353448"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err500</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Failed to update bug&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | (Init+ Only) Handles deleting a single bug </span><span>
</span><span id="line-100"></span><span class="annot"><a href="BugApi.html#deleteBugHandler"><span class="hs-identifier hs-type">deleteBugHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the requesting user (init+)</span><span>
</span><span id="line-101"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique id of the bug to delete</span><span>
</span><span id="line-102"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handler</span></span><span> </span><span class="annot"><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-type">BugChangedResponseMessage</span></a></span><span>
</span><span id="line-103"></span><span id="deleteBugHandler"><span class="annot"><span class="annottext">deleteBugHandler :: AuthenticatedUser -&gt; Int64 -&gt; Handler BugChangedResponseMessage
</span><a href="BugApi.html#deleteBugHandler"><span class="hs-identifier hs-var hs-var">deleteBugHandler</span></a></span></span><span> </span><span id="local-6989586621679353447"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353447"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353446"><span class="annot"><span class="annottext">bId :: Int64
</span><a href="#local-6989586621679353446"><span class="hs-identifier hs-var">bId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Handler () -&gt; Handler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserInit"><span class="hs-identifier hs-var">isUserInit</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353447"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServerError -&gt; Handler ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err401</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;User must be Initiate role or higher&quot;</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679353445"><span class="annot"><span class="annottext">Either IOHError Bool
</span><a href="#local-6989586621679353445"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either IOHError Bool) -&gt; Handler (Either IOHError Bool)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either IOHError Bool) -&gt; Handler (Either IOHError Bool))
-&gt; IO (Either IOHError Bool) -&gt; Handler (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64 -&gt; IO (Either IOHError Bool)
</span><a href="IOH.html#removeBug"><span class="hs-identifier hs-var">IOH.removeBug</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353447"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353446"><span class="hs-identifier hs-var">bId</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool
</span><a href="#local-6989586621679353445"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage)
-&gt; BugChangedResponseMessage -&gt; Handler BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64 -&gt; String -&gt; String -&gt; BugChangedResponseMessage
</span><a href="ApiTypes.html#BugChangedResponseMessage"><span class="hs-identifier hs-var">BugChangedResponseMessage</span></a></span><span> </span><span class="annot"><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353446"><span class="hs-identifier hs-var">bId</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;OK&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BugChangedResponseMessage)
-&gt; String -&gt; BugChangedResponseMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353446"><span class="hs-identifier hs-var">bId</span></a></span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-type">IOHAuthError</span></a></span><span> </span><span id="local-6989586621679353444"><span class="annot"><span class="annottext">m :: String
</span><a href="#local-6989586621679353444"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err400</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">packChars</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353444"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-type">IOHFetchError</span></a></span><span> </span><span id="local-6989586621679353443"><span class="annot"><span class="annottext">m :: String
</span><a href="#local-6989586621679353443"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err404</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">packChars</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353443"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-identifier">_</span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerError -&gt; Handler BugChangedResponseMessage
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">Servant.throwError</span></span><span> </span><span class="annot"><span class="annottext">ServerError
</span><span class="hs-identifier hs-var">err500</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errBody :: ByteString
</span><span class="hs-identifier hs-var">errBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Failed to delete bug&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-112"></span></pre></body></html>