<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | IO Abstraction handler used to interact with an underlying</span><span>
</span><span id="line-2"></span><span class="hs-comment">--  data store. All Datastore io should go through this.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IOH</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IOH.html#initIO"><span class="hs-identifier">initIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>      </span><span class="annot"><a href="IOH.html#storeSpellData"><span class="hs-identifier">storeSpellData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="IOH.html#getBuilds"><span class="hs-identifier">getBuilds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>      </span><span class="annot"><a href="IOH.html#getSpells"><span class="hs-identifier">getSpells</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="IOH.html#storeBug"><span class="hs-identifier">storeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>      </span><span class="annot"><a href="IOH.html#changeBug"><span class="hs-identifier">changeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="IOH.html#getBug"><span class="hs-identifier">getBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="IOH.html#removeBug"><span class="hs-identifier">removeBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="IOH.html#getBugs"><span class="hs-identifier">getBugs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><a href="IOH.html#getBugsByUser"><span class="hs-identifier">getBugsByUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>      </span><span class="annot"><a href="IOH.html#storeUser"><span class="hs-identifier">storeUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>      </span><span class="annot"><a href="IOH.html#getUser"><span class="hs-identifier">getUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><a href="IOH.html#getUserByName"><span class="hs-identifier">getUserByName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="IOH.html#getUsers"><span class="hs-identifier">getUsers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="IOH.html#getUserL"><span class="hs-identifier">getUserL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="IOH.html#changeUserRole"><span class="hs-identifier">changeUserRole</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><a href="IOH.html#storeComment"><span class="hs-identifier">storeComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><a href="IOH.html#getComments"><span class="hs-identifier">getComments</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="IOH.html#deleteComment"><span class="hs-identifier">IOH.deleteComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier">IOHError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span class="hs-comment">---</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int64</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOException</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-comment">---</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SQLiteProvider.html"><span class="hs-identifier">SQLiteProvider</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SQLiteFactory.html#createDb"><span class="hs-identifier">createDb</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#deleteBug"><span class="hs-identifier">deleteBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#insertBug"><span class="hs-identifier">insertBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#insertComment"><span class="hs-identifier">insertComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#insertSpellData"><span class="hs-identifier">insertSpellData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#insertUser"><span class="hs-identifier">insertUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectBug"><span class="hs-identifier">selectBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectBugs%27"><span class="hs-identifier">selectBugs'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectBugsByUser"><span class="hs-identifier">selectBugsByUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectBuilds"><span class="hs-identifier">selectBuilds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectComment"><span class="hs-identifier">selectComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectComments"><span class="hs-identifier">selectComments</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectSpells"><span class="hs-identifier">selectSpells</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectUser"><span class="hs-identifier">selectUser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectUserByName"><span class="hs-identifier">selectUserByName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectUserL"><span class="hs-identifier">selectUserL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#selectUsers"><span class="hs-identifier">selectUsers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#updateBug"><span class="hs-identifier">updateBug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#updateUserRole"><span class="hs-identifier">updateUserRole</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#deleteComment"><span class="hs-identifier">deleteComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>      </span><span class="annot"><a href="SQLiteProvider.html#deleteCommentsByUser"><span class="hs-identifier">deleteCommentsByUser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GameDataTypes.html"><span class="hs-identifier">GameDataTypes</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GameDataTypes.html#SpellData"><span class="hs-identifier">SpellData</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ApiTypes.html"><span class="hs-identifier">ApiTypes</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier">Bug</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier">BugDetail</span></a></span><span class="hs-special">(</span><span class="annot"><a href="ApiTypes.html#bugdtSeverity"><span class="hs-identifier">bugdtSeverity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtType"><span class="hs-identifier">bugdtType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtTitle"><span class="hs-identifier">bugdtTitle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtSpellId"><span class="hs-identifier">bugdtSpellId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>                </span><span class="annot"><a href="ApiTypes.html#bugdtBuildId"><span class="hs-identifier">bugdtBuildId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtSpec"><span class="hs-identifier">bugdtSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtTags"><span class="hs-identifier">bugdtTags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtDescription"><span class="hs-identifier">bugdtDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtSteps"><span class="hs-identifier">bugdtSteps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>                </span><span class="annot"><a href="ApiTypes.html#bugdtContent"><span class="hs-identifier">bugdtContent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtBlueTrackerLink"><span class="hs-identifier">bugdtBlueTrackerLink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier">bugdtSubmitter</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><a href="ApiTypes.html#BuildT"><span class="hs-identifier">BuildT</span></a></span><span class="hs-special">(</span><span class="annot"><a href="ApiTypes.html#BuildT"><span class="hs-identifier">BuildT</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><a href="ApiTypes.html#Comment"><span class="hs-identifier">Comment</span></a></span><span class="hs-special">(</span><span class="annot"><a href="ApiTypes.html#cBody"><span class="hs-identifier">cBody</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="ApiTypes.html#cUserId"><span class="hs-identifier">cUserId</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><a href="ApiTypes.html#SpellT"><span class="hs-identifier">SpellT</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AuthTypes.html"><span class="hs-identifier">AuthTypes</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="AuthTypes.html#isUserAdmin"><span class="hs-identifier">isUserAdmin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><a href="AuthTypes.html#isUserInit"><span class="hs-identifier">isUserInit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><a href="AuthTypes.html#isUserMod"><span class="hs-identifier">isUserMod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>      </span><span class="annot"><a href="AuthTypes.html#userAdminRole"><span class="hs-identifier">userAdminRole</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier">AuthenticatedUser</span></a></span><span class="hs-special">(</span><span class="annot"><a href="AuthTypes.html#auId"><span class="hs-identifier">auId</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>      </span><span class="annot"><a href="AuthTypes.html#User"><span class="hs-identifier">User</span></a></span><span class="hs-special">(</span><span class="annot"><a href="AuthTypes.html#userRole"><span class="hs-identifier">userRole</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><a href="AuthTypes.html#UserL"><span class="hs-identifier">UserL</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-comment">---</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">{- Data Types -}</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Represents differnet errors that can occur during IOH actions</span><span>
</span><span id="line-75"></span><span class="hs-keyword">data</span><span> </span><span id="IOHError"><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-var">IOHError</span></a></span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="IOHInsertError"><span class="annot"><a href="IOH.html#IOHInsertError"><span class="hs-identifier hs-var">IOHInsertError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IOHFetchError"><span class="annot"><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IOHDeleteError"><span class="annot"><a href="IOH.html#IOHDeleteError"><span class="hs-identifier hs-var">IOHDeleteError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IOHAuthError"><span class="annot"><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IOHUpdateError"><span class="annot"><a href="IOH.html#IOHUpdateError"><span class="hs-identifier hs-var">IOHUpdateError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679353232"><span id="local-6989586621679353234"><span id="local-6989586621679353236"><span class="annot"><span class="annottext">Int -&gt; IOHError -&gt; ShowS
[IOHError] -&gt; ShowS
IOHError -&gt; String
(Int -&gt; IOHError -&gt; ShowS)
-&gt; (IOHError -&gt; String) -&gt; ([IOHError] -&gt; ShowS) -&gt; Show IOHError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [IOHError] -&gt; ShowS
$cshowList :: [IOHError] -&gt; ShowS
show :: IOHError -&gt; String
$cshow :: IOHError -&gt; String
showsPrec :: Int -&gt; IOHError -&gt; ShowS
$cshowsPrec :: Int -&gt; IOHError -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">{- Functions -}</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Calls on the underlying provider to init its datastore</span><span>
</span><span id="line-86"></span><span class="annot"><a href="IOH.html#initIO"><span class="hs-identifier hs-type">initIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ Do a hardInit</span><span>
</span><span id="line-87"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span id="initIO"><span class="annot"><span class="annottext">initIO :: Bool -&gt; IO ()
</span><a href="IOH.html#initIO"><span class="hs-identifier hs-var hs-var">initIO</span></a></span></span><span> </span><span id="local-6989586621679353230"><span class="annot"><span class="annottext">isHardInit :: Bool
</span><a href="#local-6989586621679353230"><span class="hs-identifier hs-var">isHardInit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Init started...&quot;</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO ()
</span><a href="SQLiteFactory.html#createDb"><span class="hs-identifier hs-var">SQLiteProvider.createDb</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353230"><span class="hs-identifier hs-var">isHardInit</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Init complete.&quot;</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Attempt to store a full SpellData collection (from a GameData update)</span><span>
</span><span id="line-94"></span><span class="annot"><a href="IOH.html#storeSpellData"><span class="hs-identifier hs-type">storeSpellData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameDataTypes.html#SpellData"><span class="hs-identifier hs-type">SpellData</span></a></span><span> </span><span class="hs-comment">-- ^ the SpellData to store</span><span>
</span><span id="line-95"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="storeSpellData"><span class="annot"><span class="annottext">storeSpellData :: SpellData -&gt; IO ()
</span><a href="IOH.html#storeSpellData"><span class="hs-identifier hs-var hs-var">storeSpellData</span></a></span></span><span> </span><span id="local-6989586621679353228"><span class="annot"><span class="annottext">sd :: SpellData
</span><a href="#local-6989586621679353228"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Inserting SpellData...&quot;</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">SpellData -&gt; IO ()
</span><a href="SQLiteProvider.html#insertSpellData"><span class="hs-identifier hs-var">SQLiteProvider.insertSpellData</span></a></span><span> </span><span class="annot"><span class="annottext">SpellData
</span><a href="#local-6989586621679353228"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Done.&quot;</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Attempt to insert a Bug into the data store</span><span>
</span><span id="line-102"></span><span class="annot"><a href="IOH.html#storeBug"><span class="hs-identifier hs-type">storeBug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">ApiTypes.BugDetail</span></a></span><span> </span><span class="hs-comment">-- ^ The bug to insert</span><span>
</span><span id="line-103"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ IO (id of the inserted bug or Nothing)</span><span>
</span><span id="line-104"></span><span id="storeBug"><span class="annot"><span class="annottext">storeBug :: BugDetail -&gt; IO (Maybe Int64)
</span><a href="IOH.html#storeBug"><span class="hs-identifier hs-var hs-var">storeBug</span></a></span></span><span> </span><span id="local-6989586621679353227"><span class="annot"><span class="annottext">bd :: BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Attempting to store BugDetail...&quot;</span></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679353226"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353226"><span class="hs-identifier hs-var">bId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Int64)
-&gt; (IOException -&gt; IO (Maybe Int64)) -&gt; IO (Maybe Int64)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; String
-&gt; String
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; Int64
-&gt; IO (Maybe Int64)
</span><a href="SQLiteProvider.html#insertBug"><span class="hs-identifier hs-var">SQLiteProvider.insertBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353225"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353224"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353223"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353222"><span class="hs-identifier hs-var">ta</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353221"><span class="hs-identifier hs-var">sId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353220"><span class="hs-identifier hs-var">buId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353219"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353218"><span class="hs-identifier hs-var">de</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353217"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353216"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353215"><span class="hs-identifier hs-var">btl</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353214"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353213"><span class="annot"><span class="annottext">e :: IOException
</span><a href="#local-6989586621679353213"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Error on storeBug &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679353213"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int64 -&gt; IO (Maybe Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353226"><span class="hs-identifier hs-var">bId</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353211"><span class="annot"><span class="annottext">i :: Int64
</span><a href="#local-6989586621679353211"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Stored BugDetail with ID &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353211"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">Maybe Int64 -&gt; IO (Maybe Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int64 -&gt; IO (Maybe Int64))
-&gt; Maybe Int64 -&gt; IO (Maybe Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353211"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Failed to store bug.&quot;</span></span><span>
</span><span id="line-115"></span><span>            </span><span class="annot"><span class="annottext">Maybe Int64 -&gt; IO (Maybe Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>        </span><span id="local-6989586621679353225"><span class="annot"><span class="annottext">s :: Int
</span><a href="#local-6989586621679353225"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugSeverity -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BugDetail -&gt; BugSeverity
</span><a href="ApiTypes.html#bugdtSeverity"><span class="hs-identifier hs-var hs-var">bugdtSeverity</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>        </span><span id="local-6989586621679353224"><span class="annot"><span class="annottext">t :: Int
</span><a href="#local-6989586621679353224"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugType -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BugDetail -&gt; BugType
</span><a href="ApiTypes.html#bugdtType"><span class="hs-identifier hs-var hs-var">bugdtType</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span id="local-6989586621679353223"><span class="annot"><span class="annottext">ti :: String
</span><a href="#local-6989586621679353223"><span class="hs-identifier hs-var hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; String
</span><a href="ApiTypes.html#bugdtTitle"><span class="hs-identifier hs-var hs-var">bugdtTitle</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span id="local-6989586621679353221"><span class="annot"><span class="annottext">sId :: Int
</span><a href="#local-6989586621679353221"><span class="hs-identifier hs-var hs-var">sId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int
</span><a href="ApiTypes.html#bugdtSpellId"><span class="hs-identifier hs-var hs-var">bugdtSpellId</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span id="local-6989586621679353220"><span class="annot"><span class="annottext">buId :: Int
</span><a href="#local-6989586621679353220"><span class="hs-identifier hs-var hs-var">buId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int
</span><a href="ApiTypes.html#bugdtBuildId"><span class="hs-identifier hs-var hs-var">bugdtBuildId</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679353219"><span class="annot"><span class="annottext">sp :: Int
</span><a href="#local-6989586621679353219"><span class="hs-identifier hs-var hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Specialisation -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BugDetail -&gt; Specialisation
</span><a href="ApiTypes.html#bugdtSpec"><span class="hs-identifier hs-var hs-var">bugdtSpec</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679353222"><span class="annot"><span class="annottext">ta :: String
</span><a href="#local-6989586621679353222"><span class="hs-identifier hs-var">ta</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353218"><span class="annot"><span class="annottext">de :: String
</span><a href="#local-6989586621679353218"><span class="hs-identifier hs-var">de</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353217"><span class="annot"><span class="annottext">st :: String
</span><a href="#local-6989586621679353217"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353216"><span class="annot"><span class="annottext">ct :: String
</span><a href="#local-6989586621679353216"><span class="hs-identifier hs-var">ct</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353215"><span class="annot"><span class="annottext">btl :: String
</span><a href="#local-6989586621679353215"><span class="hs-identifier hs-var">btl</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">((BugDetail -&gt; Maybe String) -&gt; String)
-&gt; [BugDetail -&gt; Maybe String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353209"><span class="annot"><span class="annottext">f :: BugDetail -&gt; Maybe String
</span><a href="#local-6989586621679353209"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; String) -&gt; Maybe String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="#local-6989586621679353209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="ApiTypes.html#bugdtTags"><span class="hs-identifier hs-var hs-var">bugdtTags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="ApiTypes.html#bugdtDescription"><span class="hs-identifier hs-var hs-var">bugdtDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="ApiTypes.html#bugdtSteps"><span class="hs-identifier hs-var hs-var">bugdtSteps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="ApiTypes.html#bugdtContent"><span class="hs-identifier hs-var hs-var">bugdtContent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Maybe String
</span><a href="ApiTypes.html#bugdtBlueTrackerLink"><span class="hs-identifier hs-var hs-var">bugdtBlueTrackerLink</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679353214"><span class="annot"><span class="annottext">u :: Int64
</span><a href="#local-6989586621679353214"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int64
</span><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier hs-var hs-var">bugdtSubmitter</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353227"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Attempt to fetch a bug from the data store</span><span>
</span><span id="line-129"></span><span class="annot"><a href="IOH.html#getBug"><span class="hs-identifier hs-type">getBug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ Unique Id of the bug to fetch</span><span>
</span><span id="line-130"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">ApiTypes.BugDetail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="getBug"><span class="annot"><span class="annottext">getBug :: Int64 -&gt; IO (Maybe BugDetail)
</span><a href="IOH.html#getBug"><span class="hs-identifier hs-var hs-var">getBug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe BugDetail)
</span><a href="SQLiteProvider.html#selectBug"><span class="hs-identifier hs-var">SQLiteProvider.selectBug</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Attempt to update the stored data of a bug</span><span>
</span><span id="line-134"></span><span class="annot"><a href="IOH.html#changeBug"><span class="hs-identifier hs-type">changeBug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the user making the request</span><span>
</span><span id="line-135"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique id of the bug to update</span><span>
</span><span id="line-136"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApiTypes.html#BugDetail"><span class="hs-identifier hs-type">ApiTypes.BugDetail</span></a></span><span> </span><span class="hs-comment">-- ^ the modified bug detail data</span><span>
</span><span id="line-137"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span id="changeBug"><span class="annot"><span class="annottext">changeBug :: AuthenticatedUser
-&gt; Int64 -&gt; BugDetail -&gt; IO (Either IOHError Int64)
</span><a href="IOH.html#changeBug"><span class="hs-identifier hs-var hs-var">changeBug</span></a></span></span><span> </span><span id="local-6989586621679353208"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353208"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353207"><span class="annot"><span class="annottext">bugId :: Int64
</span><a href="#local-6989586621679353207"><span class="hs-identifier hs-var">bugId</span></a></span></span><span> </span><span id="local-6989586621679353206"><span class="annot"><span class="annottext">bd :: BugDetail
</span><a href="#local-6989586621679353206"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679353205"><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353205"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe BugDetail)
</span><a href="IOH.html#getBug"><span class="hs-identifier hs-var">getBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353207"><span class="hs-identifier hs-var">bugId</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353205"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353204"><span class="annot"><span class="annottext">bug :: BugDetail
</span><a href="#local-6989586621679353204"><span class="hs-identifier hs-var">bug</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserMod"><span class="hs-identifier hs-var">isUserMod</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353208"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64
</span><a href="AuthTypes.html#auId"><span class="hs-identifier hs-var hs-var">auId</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353208"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int64
</span><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier hs-var hs-var">bugdtSubmitter</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353204"><span class="hs-identifier hs-var">bug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>                </span><span id="local-6989586621679353202"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353202"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; BugDetail -&gt; IO (Maybe Int64)
</span><a href="SQLiteProvider.html#updateBug"><span class="hs-identifier hs-var">SQLiteProvider.updateBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353207"><span class="hs-identifier hs-var">bugId</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353206"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-144"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353202"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353201"><span class="annot"><span class="annottext">id :: Int64
</span><a href="#local-6989586621679353201"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Either IOHError Int64
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353201"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-146"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Int64)
-&gt; IOHError -&gt; Either IOHError Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHInsertError"><span class="hs-identifier hs-var">IOHInsertError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Failed to update bug with id &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353207"><span class="hs-identifier hs-var">bugId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Int64)
-&gt; IOHError -&gt; Either IOHError Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient permissions&quot;</span></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Int64)
-&gt; IOHError -&gt; Either IOHError Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Requested bug not found&quot;</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Attempt to delete a bug from the data store</span><span>
</span><span id="line-151"></span><span class="annot"><a href="IOH.html#removeBug"><span class="hs-identifier hs-type">removeBug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ The user making the request</span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique id of the bug to delete</span><span>
</span><span id="line-153"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span id="removeBug"><span class="annot"><span class="annottext">removeBug :: AuthenticatedUser -&gt; Int64 -&gt; IO (Either IOHError Bool)
</span><a href="IOH.html#removeBug"><span class="hs-identifier hs-var hs-var">removeBug</span></a></span></span><span> </span><span id="local-6989586621679353200"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353200"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353199"><span class="annot"><span class="annottext">bugId :: Int64
</span><a href="#local-6989586621679353199"><span class="hs-identifier hs-var">bugId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679353198"><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353198"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe BugDetail)
</span><a href="IOH.html#getBug"><span class="hs-identifier hs-var">getBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353199"><span class="hs-identifier hs-var">bugId</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe BugDetail
</span><a href="#local-6989586621679353198"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353197"><span class="annot"><span class="annottext">bug :: BugDetail
</span><a href="#local-6989586621679353197"><span class="hs-identifier hs-var">bug</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserMod"><span class="hs-identifier hs-var">isUserMod</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353200"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64
</span><a href="AuthTypes.html#auId"><span class="hs-identifier hs-var hs-var">auId</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353200"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BugDetail -&gt; Int64
</span><a href="ApiTypes.html#bugdtSubmitter"><span class="hs-identifier hs-var hs-var">bugdtSubmitter</span></a></span><span> </span><span class="annot"><span class="annottext">BugDetail
</span><a href="#local-6989586621679353197"><span class="hs-identifier hs-var">bug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>                </span><span id="local-6989586621679353196"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353196"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO Bool
</span><a href="SQLiteProvider.html#deleteBug"><span class="hs-identifier hs-var">SQLiteProvider.deleteBug</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353199"><span class="hs-identifier hs-var">bugId</span></a></span><span>
</span><span id="line-160"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353196"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either IOHError Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Bool)
-&gt; IOHError -&gt; Either IOHError Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHDeleteError"><span class="hs-identifier hs-var">IOHDeleteError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Failed to delete bug&quot;</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Bool)
-&gt; IOHError -&gt; Either IOHError Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient permissions&quot;</span></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(IOHError -&gt; Either IOHError Bool)
-&gt; IOHError -&gt; Either IOHError Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Requested bug not found&quot;</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Fetches all the bugs from the data store</span><span>
</span><span id="line-165"></span><span class="annot"><a href="IOH.html#getBugs"><span class="hs-identifier hs-type">getBugs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Limit on how many bugs to fetch</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier hs-type">ApiTypes.Bug</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span id="getBugs"><span class="annot"><span class="annottext">getBugs :: Int -&gt; IO [Bug]
</span><a href="IOH.html#getBugs"><span class="hs-identifier hs-var hs-var">getBugs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [Bug]
</span><a href="SQLiteProvider.html#selectBugs%27"><span class="hs-identifier hs-var">SQLiteProvider.selectBugs'</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Fetches all the bugs from the data store that were submitted by the</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- provided userId</span><span>
</span><span id="line-171"></span><span class="annot"><a href="IOH.html#getBugsByUser"><span class="hs-identifier hs-type">getBugsByUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the userId to fetch submitted bugs for</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#Bug"><span class="hs-identifier hs-type">ApiTypes.Bug</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span id="getBugsByUser"><span class="annot"><span class="annottext">getBugsByUser :: Int64 -&gt; IO [Bug]
</span><a href="IOH.html#getBugsByUser"><span class="hs-identifier hs-var hs-var">getBugsByUser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO [Bug]
</span><a href="SQLiteProvider.html#selectBugsByUser"><span class="hs-identifier hs-var">SQLiteProvider.selectBugsByUser</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Fetches all builds from the data store</span><span>
</span><span id="line-176"></span><span class="annot"><a href="IOH.html#getBuilds"><span class="hs-identifier hs-type">getBuilds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#BuildT"><span class="hs-identifier hs-type">ApiTypes.BuildT</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span id="getBuilds"><span class="annot"><span class="annottext">getBuilds :: IO [BuildT]
</span><a href="IOH.html#getBuilds"><span class="hs-identifier hs-var hs-var">getBuilds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">((Int, String, String) -&gt; BuildT)
-&gt; [(Int, String, String)] -&gt; [BuildT]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679353195"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679353195"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679353194"><span class="annot"><span class="annottext">y :: String
</span><a href="#local-6989586621679353194"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679353193"><span class="annot"><span class="annottext">z :: String
</span><a href="#local-6989586621679353193"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String -&gt; BuildT
</span><a href="ApiTypes.html#BuildT"><span class="hs-identifier hs-var">ApiTypes.BuildT</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353195"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353194"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353193"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, String, String)] -&gt; [BuildT])
-&gt; IO [(Int, String, String)] -&gt; IO [BuildT]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO [(Int, String, String)]
</span><a href="SQLiteProvider.html#selectBuilds"><span class="hs-identifier hs-var">SQLiteProvider.selectBuilds</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Fetches all spells from the data store</span><span>
</span><span id="line-181"></span><span class="annot"><a href="IOH.html#getSpells"><span class="hs-identifier hs-type">getSpells</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#SpellT"><span class="hs-identifier hs-type">ApiTypes.SpellT</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span id="getSpells"><span class="annot"><span class="annottext">getSpells :: IO [SpellT]
</span><a href="IOH.html#getSpells"><span class="hs-identifier hs-var hs-var">getSpells</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [SpellT]
</span><a href="SQLiteProvider.html#selectSpells"><span class="hs-identifier hs-var">SQLiteProvider.selectSpells</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Attempts to insert a User in to the data store</span><span>
</span><span id="line-185"></span><span class="annot"><a href="IOH.html#storeUser"><span class="hs-identifier hs-type">storeUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#User"><span class="hs-identifier hs-type">AuthTypes.User</span></a></span><span> </span><span class="hs-comment">-- ^ the user to insert</span><span>
</span><span id="line-186"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span id="storeUser"><span class="annot"><span class="annottext">storeUser :: User -&gt; IO (Either IOHError Int64)
</span><a href="IOH.html#storeUser"><span class="hs-identifier hs-var hs-var">storeUser</span></a></span></span><span> </span><span id="local-6989586621679353191"><span class="annot"><span class="annottext">user :: User
</span><a href="#local-6989586621679353191"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679353190"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353190"><span class="hs-identifier hs-var">uId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">User -&gt; IO (Maybe Int64)
</span><a href="SQLiteProvider.html#insertUser"><span class="hs-identifier hs-var">SQLiteProvider.insertUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679353191"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353190"><span class="hs-identifier hs-var">uId</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353189"><span class="annot"><span class="annottext">id :: Int64
</span><a href="#local-6989586621679353189"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Either IOHError Int64
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353189"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHInsertError"><span class="hs-identifier hs-var">IOHInsertError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Attempts to fetch a user from the data store</span><span>
</span><span id="line-194"></span><span class="annot"><a href="IOH.html#getUser"><span class="hs-identifier hs-type">getUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ unique UserId of the user to fetch</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><a href="AuthTypes.html#User"><span class="hs-identifier hs-type">AuthTypes.User</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="getUser"><span class="annot"><span class="annottext">getUser :: Int64 -&gt; IO (Either IOHError User)
</span><a href="IOH.html#getUser"><span class="hs-identifier hs-var hs-var">getUser</span></a></span></span><span> </span><span id="local-6989586621679353188"><span class="annot"><span class="annottext">uId :: Int64
</span><a href="#local-6989586621679353188"><span class="hs-identifier hs-var">uId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679353187"><span class="annot"><span class="annottext">Maybe User
</span><a href="#local-6989586621679353187"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe User)
</span><a href="SQLiteProvider.html#selectUser"><span class="hs-identifier hs-var">SQLiteProvider.selectUser</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353188"><span class="hs-identifier hs-var">uId</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe User
</span><a href="#local-6989586621679353187"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353186"><span class="annot"><span class="annottext">user :: User
</span><a href="#local-6989586621679353186"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError User -&gt; IO (Either IOHError User)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError User -&gt; IO (Either IOHError User))
-&gt; Either IOHError User -&gt; IO (Either IOHError User)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; Either IOHError User
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679353186"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError User -&gt; IO (Either IOHError User)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError User -&gt; IO (Either IOHError User))
-&gt; Either IOHError User -&gt; IO (Either IOHError User)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError User
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Attempts to fetch a user from the data store (by name)</span><span>
</span><span id="line-203"></span><span class="annot"><a href="IOH.html#getUserByName"><span class="hs-identifier hs-type">getUserByName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ unique username of the user to fetch</span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><a href="AuthTypes.html#User"><span class="hs-identifier hs-type">AuthTypes.User</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span id="getUserByName"><span class="annot"><span class="annottext">getUserByName :: String -&gt; IO (Either IOHError User)
</span><a href="IOH.html#getUserByName"><span class="hs-identifier hs-var hs-var">getUserByName</span></a></span></span><span> </span><span id="local-6989586621679353185"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679353185"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679353184"><span class="annot"><span class="annottext">Maybe User
</span><a href="#local-6989586621679353184"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Maybe User)
</span><a href="SQLiteProvider.html#selectUserByName"><span class="hs-identifier hs-var">SQLiteProvider.selectUserByName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353185"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe User
</span><a href="#local-6989586621679353184"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353183"><span class="annot"><span class="annottext">user :: User
</span><a href="#local-6989586621679353183"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError User -&gt; IO (Either IOHError User)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError User -&gt; IO (Either IOHError User))
-&gt; Either IOHError User -&gt; IO (Either IOHError User)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; Either IOHError User
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679353183"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError User -&gt; IO (Either IOHError User)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError User -&gt; IO (Either IOHError User))
-&gt; Either IOHError User -&gt; IO (Either IOHError User)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError User
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Fetches all users fromthe data store</span><span>
</span><span id="line-212"></span><span class="annot"><a href="IOH.html#getUsers"><span class="hs-identifier hs-type">getUsers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AuthTypes.html#UserL"><span class="hs-identifier hs-type">AuthTypes.UserL</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span id="getUsers"><span class="annot"><span class="annottext">getUsers :: IO [UserL]
</span><a href="IOH.html#getUsers"><span class="hs-identifier hs-var hs-var">getUsers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [UserL]
</span><a href="SQLiteProvider.html#selectUsers"><span class="hs-identifier hs-var">SQLiteProvider.selectUsers</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Fetches a subset of User properties from the data store (for User listing)</span><span>
</span><span id="line-216"></span><span class="annot"><a href="IOH.html#getUserL"><span class="hs-identifier hs-type">getUserL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ unique userId of the user to fetch</span><span>
</span><span id="line-217"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><a href="AuthTypes.html#UserL"><span class="hs-identifier hs-type">AuthTypes.UserL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span id="getUserL"><span class="annot"><span class="annottext">getUserL :: Int64 -&gt; IO (Either IOHError UserL)
</span><a href="IOH.html#getUserL"><span class="hs-identifier hs-var hs-var">getUserL</span></a></span></span><span> </span><span id="local-6989586621679353182"><span class="annot"><span class="annottext">uId :: Int64
</span><a href="#local-6989586621679353182"><span class="hs-identifier hs-var">uId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679353181"><span class="annot"><span class="annottext">Maybe UserL
</span><a href="#local-6989586621679353181"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe UserL)
</span><a href="SQLiteProvider.html#selectUserL"><span class="hs-identifier hs-var">SQLiteProvider.selectUserL</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353182"><span class="hs-identifier hs-var">uId</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe UserL
</span><a href="#local-6989586621679353181"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353180"><span class="annot"><span class="annottext">user :: UserL
</span><a href="#local-6989586621679353180"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError UserL -&gt; IO (Either IOHError UserL)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError UserL -&gt; IO (Either IOHError UserL))
-&gt; Either IOHError UserL -&gt; IO (Either IOHError UserL)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserL -&gt; Either IOHError UserL
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">UserL
</span><a href="#local-6989586621679353180"><span class="hs-identifier hs-var">user</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError UserL -&gt; IO (Either IOHError UserL)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError UserL -&gt; IO (Either IOHError UserL))
-&gt; Either IOHError UserL -&gt; IO (Either IOHError UserL)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError UserL
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Failed to fetch user with ID &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353182"><span class="hs-identifier hs-var">uId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | (Mod only) Attempts to change the userRole of a given user</span><span>
</span><span id="line-225"></span><span class="annot"><a href="IOH.html#changeUserRole"><span class="hs-identifier hs-type">changeUserRole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ The requesting user (Mod Only)</span><span>
</span><span id="line-226"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique userId of the user to change role for</span><span>
</span><span id="line-227"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ the userRole to change to </span><span>
</span><span id="line-228"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span id="changeUserRole"><span class="annot"><span class="annottext">changeUserRole :: AuthenticatedUser -&gt; Int64 -&gt; Int -&gt; IO (Either IOHError Int64)
</span><a href="IOH.html#changeUserRole"><span class="hs-identifier hs-var hs-var">changeUserRole</span></a></span></span><span> </span><span id="local-6989586621679353179"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353179"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353178"><span class="annot"><span class="annottext">userId :: Int64
</span><a href="#local-6989586621679353178"><span class="hs-identifier hs-var">userId</span></a></span></span><span> </span><span id="local-6989586621679353177"><span class="annot"><span class="annottext">role :: Int
</span><a href="#local-6989586621679353177"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserMod"><span class="hs-identifier hs-var">AuthTypes.isUserMod</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353179"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient permissions&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>        </span><span id="local-6989586621679353175"><span class="annot"><span class="annottext">Either IOHError User
</span><a href="#local-6989586621679353175"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Either IOHError User)
</span><a href="IOH.html#getUser"><span class="hs-identifier hs-var">getUser</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353178"><span class="hs-identifier hs-var">userId</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either IOHError User
</span><a href="#local-6989586621679353175"><span class="hs-identifier hs-var">user</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-type">IOHFetchError</span></a></span><span> </span><span id="local-6989586621679353174"><span class="annot"><span class="annottext">msg :: String
</span><a href="#local-6989586621679353174"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHUpdateError"><span class="hs-identifier hs-var">IOHUpdateError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679353174"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679353173"><span class="annot"><span class="annottext">u :: User
</span><a href="#local-6989586621679353173"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">User -&gt; Int
</span><a href="AuthTypes.html#userRole"><span class="hs-identifier hs-var hs-var">userRole</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679353173"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="AuthTypes.html#userAdminRole"><span class="hs-identifier hs-var">AuthTypes.userAdminRole</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserAdmin"><span class="hs-identifier hs-var">AuthTypes.isUserAdmin</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353179"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-238"></span><span>                    </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Mods cannot demote/promote admins&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>                    </span><span id="local-6989586621679353171"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353171"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (IOException -&gt; IO Bool) -&gt; IO Bool
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Int -&gt; IO Bool
</span><a href="SQLiteProvider.html#updateUserRole"><span class="hs-identifier hs-var">SQLiteProvider.updateUserRole</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353178"><span class="hs-identifier hs-var">userId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353177"><span class="hs-keyword hs-var">role</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353170"><span class="annot"><span class="annottext">e :: IOException
</span><a href="#local-6989586621679353170"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IOError on changeUserRole &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679353170"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                        </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353171"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Either IOHError Int64
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353178"><span class="hs-identifier hs-var">userId</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHUpdateError"><span class="hs-identifier hs-var">IOHUpdateError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Failed to update user \
                                    \ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353178"><span class="hs-identifier hs-var">userId</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; with role &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353177"><span class="hs-keyword hs-var">role</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">{-- Comments --}</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Attempts to insert a Comment into the data store</span><span>
</span><span id="line-249"></span><span class="annot"><a href="IOH.html#storeComment"><span class="hs-identifier hs-type">storeComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the requesting user</span><span>
</span><span id="line-250"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ApiTypes.html#Comment"><span class="hs-identifier hs-type">ApiTypes.Comment</span></a></span><span> </span><span class="hs-comment">-- ^ the comment to insert</span><span>
</span><span id="line-251"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span id="storeComment"><span class="annot"><span class="annottext">storeComment :: AuthenticatedUser -&gt; Comment -&gt; IO (Either IOHError Int64)
</span><a href="IOH.html#storeComment"><span class="hs-identifier hs-var hs-var">storeComment</span></a></span></span><span> </span><span id="local-6989586621679353169"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353169"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353168"><span class="annot"><span class="annottext">cm :: Comment
</span><a href="#local-6989586621679353168"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserInit"><span class="hs-identifier hs-var">AuthTypes.isUserInit</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353169"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient permissions&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Comment -&gt; String
</span><a href="ApiTypes.html#cBody"><span class="hs-identifier hs-var hs-var">cBody</span></a></span><span> </span><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621679353168"><span class="hs-identifier hs-var">cm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHInsertError"><span class="hs-identifier hs-var">IOHInsertError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Comment bodies can only be 500 characters long&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[IOH] Attempting to store Comment..&quot;</span></span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679353165"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353165"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Comment -&gt; IO (Maybe Int64)
</span><a href="SQLiteProvider.html#insertComment"><span class="hs-identifier hs-var">SQLiteProvider.insertComment</span></a></span><span> </span><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621679353168"><span class="hs-identifier hs-var">cm</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679353165"><span class="hs-identifier hs-var">cId</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-261"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353164"><span class="annot"><span class="annottext">id :: Int64
</span><a href="#local-6989586621679353164"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Either IOHError Int64
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353164"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-262"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Int64 -&gt; IO (Either IOHError Int64))
-&gt; Either IOHError Int64 -&gt; IO (Either IOHError Int64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Int64
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHInsertError"><span class="hs-identifier hs-var">IOHInsertError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Failed to insert comment&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Fetches all comments for a given bugId</span><span>
</span><span id="line-265"></span><span class="annot"><a href="IOH.html#getComments"><span class="hs-identifier hs-type">getComments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ the unique bugId to fetch comments for</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="ApiTypes.html#Comment"><span class="hs-identifier hs-type">ApiTypes.Comment</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span id="getComments"><span class="annot"><span class="annottext">getComments :: Int64 -&gt; IO (Either IOHError [Comment])
</span><a href="IOH.html#getComments"><span class="hs-identifier hs-var hs-var">getComments</span></a></span></span><span> </span><span id="local-6989586621679353163"><span class="annot"><span class="annottext">bugId :: Int64
</span><a href="#local-6989586621679353163"><span class="hs-identifier hs-var">bugId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679353162"><span class="annot"><span class="annottext">[Comment]
</span><a href="#local-6989586621679353162"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Comment] -&gt; (IOException -&gt; IO [Comment]) -&gt; IO [Comment]
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; IO [Comment]
</span><a href="SQLiteProvider.html#selectComments"><span class="hs-identifier hs-var">SQLiteProvider.selectComments</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353163"><span class="hs-identifier hs-var">bugId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353161"><span class="annot"><span class="annottext">e :: IOException
</span><a href="#local-6989586621679353161"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IOError on getComments &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679353161"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">[Comment] -&gt; IO [Comment]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">Either IOHError [Comment] -&gt; IO (Either IOHError [Comment])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError [Comment] -&gt; IO (Either IOHError [Comment]))
-&gt; Either IOHError [Comment] -&gt; IO (Either IOHError [Comment])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Comment] -&gt; Either IOHError [Comment]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">[Comment]
</span><a href="#local-6989586621679353162"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Deletes a single comment from the data store</span><span>
</span><span id="line-274"></span><span class="annot"><a href="IOH.html#deleteComment"><span class="hs-identifier hs-type">deleteComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AuthTypes.html#AuthenticatedUser"><span class="hs-identifier hs-type">AuthenticatedUser</span></a></span><span> </span><span class="hs-comment">-- ^ the requesting user</span><span>
</span><span id="line-275"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-comment">-- ^ The id of the comment to delete</span><span>
</span><span id="line-276"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="IOH.html#IOHError"><span class="hs-identifier hs-type">IOHError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span id="deleteComment"><span class="annot"><span class="annottext">deleteComment :: AuthenticatedUser -&gt; Int64 -&gt; IO (Either IOHError Bool)
</span><a href="IOH.html#deleteComment"><span class="hs-identifier hs-var hs-var">deleteComment</span></a></span></span><span> </span><span id="local-6989586621679353160"><span class="annot"><span class="annottext">au :: AuthenticatedUser
</span><a href="#local-6989586621679353160"><span class="hs-identifier hs-var">au</span></a></span></span><span> </span><span id="local-6989586621679353159"><span class="annot"><span class="annottext">cId :: Int64
</span><a href="#local-6989586621679353159"><span class="hs-identifier hs-var">cId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserInit"><span class="hs-identifier hs-var">AuthTypes.isUserInit</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353160"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Insufficient permissions&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621679353158"><span class="annot"><span class="annottext">Maybe Comment
</span><a href="#local-6989586621679353158"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IO (Maybe Comment)
</span><a href="SQLiteProvider.html#selectComment"><span class="hs-identifier hs-var">SQLiteProvider.selectComment</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353159"><span class="hs-identifier hs-var">cId</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Comment
</span><a href="#local-6989586621679353158"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHFetchError"><span class="hs-identifier hs-var">IOHFetchError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Comment not found&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353157"><span class="annot"><span class="annottext">x :: Comment
</span><a href="#local-6989586621679353157"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Comment -&gt; Int64
</span><a href="ApiTypes.html#cUserId"><span class="hs-identifier hs-var hs-var">cUserId</span></a></span><span> </span><span class="annot"><span class="annottext">Comment
</span><a href="#local-6989586621679353157"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Int64
</span><a href="AuthTypes.html#auId"><span class="hs-identifier hs-var hs-var">auId</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353160"><span class="hs-identifier hs-var">au</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthenticatedUser -&gt; Bool
</span><a href="AuthTypes.html#isUserMod"><span class="hs-identifier hs-var">isUserMod</span></a></span><span> </span><span class="annot"><span class="annottext">AuthenticatedUser
</span><a href="#local-6989586621679353160"><span class="hs-identifier hs-var">au</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-286"></span><span>                    </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IOHError -&gt; Either IOHError Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IOHError
</span><a href="IOH.html#IOHAuthError"><span class="hs-identifier hs-var">IOHAuthError</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Not allowed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>                    </span><span id="local-6989586621679353155"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679353155"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (IOException -&gt; IO Bool) -&gt; IO Bool
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; IO Bool
</span><a href="SQLiteProvider.html#deleteComment"><span class="hs-identifier hs-var">SQLiteProvider.deleteComment</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679353159"><span class="hs-identifier hs-var">cId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353154"><span class="annot"><span class="annottext">e :: IOException
</span><a href="#local-6989586621679353154"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;IO Error on delete comment &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679353154"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>                        </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>                    </span><span class="annot"><span class="annottext">Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either IOHError Bool -&gt; IO (Either IOHError Bool))
-&gt; Either IOHError Bool -&gt; IO (Either IOHError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either IOHError Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-292"></span></pre></body></html>